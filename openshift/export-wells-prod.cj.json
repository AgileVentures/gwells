{
    "apiVersion": "batch/v1beta1",
    "kind": "CronJob",
    "metadata": {
      "name": "export"
    },
    "spec": {
      "schedule": "* 4 * * *",
      "jobTemplate": {
        "spec": {
          "template": {
            "spec": {
              "containers": [
                {
                  "name": "export",
                  "image": "docker-registry.default.svc:5000/moe-gwells-prod/gwells-production:production",
                  "command": ["python", "backend/manage.py", "export"],
                  "env": [
                    {
                      "name": "DATABASE_SERVICE_NAME",
                      "value": "gwells-pgsql-production"
                    },
                    {
                      "name": "DATABASE_ENGINE",
                      "value": "postgresql"
                    },
                    {
                      "name": "DATABASE_NAME",
                      "valueFrom": {
                        "secretKeyRef": {
                            "name": "gwells-pgsql-production",
                            "key": "database-name"
                        }
                      }
                    },
                    {
                        "name": "DATABASE_USER",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "gwells-pgsql-production",
                                "key": "database-user"
                            }
                        }
                    },
                    {
                        "name": "DATABASE_PASSWORD",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "gwells-pgsql-production",
                                "key": "database-password"
                            }
                        }
                    },
                    {
                        "name": "DATABASE_SCHEMA",
                        "value": "public"
                    },
                    {
                      "name": "MINIO_ACCESS_KEY",
                      "valueFrom": {
                          "secretKeyRef": {
                              "name": "minio-access-parameters-production",
                              "key": "MINIO_ACCESS_KEY"
                          }
                      }
                    },
                    {
                        "name": "MINIO_SECRET_KEY",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "minio-access-parameters-production",
                                "key": "MINIO_SECRET_KEY"
                            }
                        }
                    },
                    {
                        "name": "S3_PUBLIC_ACCESS_KEY",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "minio-access-parameters-production",
                                "key": "S3_PUBLIC_ACCESS_KEY"
                            }
                        }
                    },
                    {
                        "name": "S3_PUBLIC_SECRET_KEY",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "minio-access-parameters-production",
                                "key": "S3_PUBLIC_SECRET_KEY"
                            }
                        }
                    },
                    {
                        "name": "S3_HOST",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "minio-access-parameters-production",
                                "key": "S3_HOST"
                            }
                        }
                    },
                    {
                        "name": "S3_ROOT_BUCKET",
                        "valueFrom": {
                            "secretKeyRef": {
                                "name": "minio-access-parameters-production",
                                "key": "S3_ROOT_BUCKET"
                            }
                        }
                    },
                    {
                        "name": "S3_PRIVATE_HOST",
                        "valueFrom": {
                            "configMapKeyRef": {
                                "key": "S3_PRIVATE_HOST",
                                "name": "gwells-global-config-production"
                            }
                        }
                    },
                    {
                        "name": "S3_WELL_EXPORT_BUCKET",
                        "valueFrom": {
                            "configMapKeyRef": {
                                "key": "S3_WELL_EXPORT_BUCKET",
                                "name": "gwells-global-config-production"
                            }
                        }
                    },
                    {
                        "name": "S3_PRIVATE_BUCKET",
                        "valueFrom": {
                            "configMapKeyRef": {
                                "key": "S3_PRIVATE_BUCKET",
                                "name": "gwells-global-config-production"
                            }
                        }
                    }
                  ],
                  "envFrom": [
                    {
                      "configMapRef": {
                        "name": "gwells-global-config-production"
                      }
                    }
                  ]
                }
              ],
              "restartPolicy": "OnFailure"
            }
          }
        }
      }
    }
  }